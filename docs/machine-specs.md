# マシンスペック・コスト比較

## 1. 新PC（RTX 3060 + DDR4 32GB）構成案

### ローカルLLM推論性能（RTX 3060 Ti 実測値）

| モデル | tokens/sec | VRAM使用量 | 適性 |
|--------|-----------|-----------|------|
| Llama 2 7B | 73.07 | ~5GB | 汎用 |
| Mistral 7B | 71.16 | ~5GB | 汎用・高品質 |
| Qwen 2.5 7B | 58.13 | ~5GB | 日本語対応 |
| Llama 3.1 8B | 57.34 | ~5GB | 最新・汎用 |
| Falcon2 11B | 31.20 | ~7GB | 中規模 |
| Gemma2 9B | 23.80 | ~6GB | Google系 |
| Phi-4 14B (Q4) | 25-40 | ~9GB | コーディング |
| DeepSeek Coder V2 Lite 16B (Q4) | 20-35 | ~9-10GB | コーディング特化 |

### 量子化が精度に与える影響

| モデル | INT4 vs FP16 精度差 | RAG実用性 |
|--------|-------------------|----------|
| OpenChat 7B | -0.9〜-1.7% | ほぼ無劣化 |
| Mistral 7B | ±5%以内 | 安定 |
| LLaMA3 8B | -2.5〜-23.4% | タスク依存で変動大 |
| LLaMA2 7B | -0.6〜-80.2% | 長コンテキストで大幅劣化 |

**結論**: Q4_K_M量子化は Mistral / OpenChat / Qwen 系では精度維持。LLaMA2 は要注意。

### ハイブリッド構成（推奨）

```
┌─────────────────────────────────────────┐
│         autonomous_agent.py             │
│                                         │
│  タスク判定 ──→ 複雑度評価              │
│                   │                     │
│          ┌────────┴────────┐            │
│          ▼                 ▼            │
│   ローカル LLM        Claude API        │
│   (Qwen 2.5 7B /     (Haiku/Sonnet)    │
│    DeepSeek Coder)                      │
│                                         │
│   単純タスク:          複雑タスク:       │
│   - Issue トリアージ   - コードレビュー  │
│   - ラベル付与         - リファクタリング │
│   - 定型レポート       - 設計判断        │
└─────────────────────────────────────────┘
```

### 電力最適化

```bash
# RTX 3060 の電力制限（170W → 120W、性能低下 10-15%）
nvidia-smi --power-limit=120

# アイドル時のGPUスリープ
nvidia-smi --persistence-mode=1
```

---

## 2. Raspberry Pi 5 構成案

### 制約

- ローカルLLM は非実用的（Llama 8B Q4: 約 0.7-3 tok/s — 実用には遅すぎる）
- **Claude API 依存の軽量制御サーバー**として活用

### 構成

```
Raspberry Pi 5 (8GB RAM)
  └─ Python APScheduler デーモン
       ├─ Claude Haiku API → 軽量タスク
       ├─ Claude Sonnet API → 複雑タスク
       └─ ChromaDB（ローカル） → パーソナルRAG（embeddingのみローカル）
```

### メリット

- 超低消費電力（5-15W）
- 24時間稼働に最適
- 静音
- 低コスト（本体約1.5万円）

---

## 3. コスト比較（月間）

### 電気代 + API費用

| 構成 | 消費電力 | 電気代/月 | API費用/月 | 合計/月 |
|------|---------|----------|-----------|--------|
| **Raspberry Pi 5 + Claude Haiku** | 5-15W | 約200円 | 約1,500円 | **約1,700円** |
| 新PC RTX 3060（8h/日稼働） | 200-350W | 約2,530円 | 最小限 | **約2,500円** |
| 新PC RTX 3060 電力制限120W | 120-200W | 約1,400円 | 最小限 | **約1,400円** |
| 新PC RTX 3060（24h常駐） | 200-350W | 約7,600円 | 最小限 | **約7,600円** |

### Claude API コスト試算（1日100アクション想定）

| モデル | 1日あたり | 月額目安 |
|--------|----------|---------|
| Claude Haiku | 約$0.25 | **約750円** |
| Claude Sonnet | 約$1.5〜3 | 約4,500〜9,000円 |

プロンプトキャッシュ活用で **50〜90% 削減可能**。

---

## 4. 推奨構成まとめ

| 方針 | 構成 | 月額目安 | 向いているケース |
|------|------|---------|----------------|
| **コスパ重視** | Raspberry Pi 5 + Claude Haiku API | 約1,700円〜 | 軽量タスク中心、24時間稼働 |
| **性能重視** | RTX 3060 新PC + ローカルLLM ハイブリッド | 約2,500円〜 | コーディング・レビュー重視 |
| **電力節約** | RTX 3060 新PC + 電力制限 | 約1,400円〜 | 性能と電力のバランス |
| **プライバシー重視** | RTX 3060 新PC + 完全ローカル | 約2,500円〜 | 個人データ外部送信ゼロ |
